---
import type { GetStaticPaths } from "astro";
import PokemonCard from "../../components/pokemon/pokemon-card.astro";
import type { PokeAPIResponse } from "../../interfaces/pokeapi-response";
import MainLayout from "../../layouts/main-layout.astro";

export const getStaticPaths = (async ({ paginate }) => {
  const response = await fetch("https://pokeapi.co/api/v2/pokemon?limit=151");
  const { results } = (await response.json()) as PokeAPIResponse;
  return paginate(results, { pageSize: 20 });
}) satisfies GetStaticPaths;

const { page } = Astro.props;
---

<MainLayout title="Pokemon Static">
  <h1 class="mb-4 text-4xl font-bold">Listado de Pokémons</h1>
  <hr class="mb-8" />

  <section
    class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 mb-6"
    aria-label="Listado de Pokémon"
  >
    {page.data.map((pokemon) => <PokemonCard {...pokemon} />)}
  </section>

  <section class="flex justify-between">
    <div>
      <a
        class:list={[
          "btn",
          {
            disabled: !page.url.prev,
          },
        ]}
        href={page.url.prev}>Anteriores</a
      >
      <a
        class:list={[
          "btn",
          {
            disabled: !page.url.next,
          },
        ]}
        href={page.url.next}>Siguientes</a
      >
    </div>
    <span class="text-xl font-bold">Página {page.currentPage}</span>
  </section>
</MainLayout>

<style>
  .btn {
    @apply bg-blue-500 p-2 text-white rounded-md;
  }

  .disabled {
    @apply bg-gray-600 text-gray-400;
  }
</style>
